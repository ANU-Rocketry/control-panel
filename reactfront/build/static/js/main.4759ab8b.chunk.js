(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{32:function(t){t.exports={notice:"The labjack pin values are duplicated in the Python code, beware!",buttons:[{pin:{test_stand:"ETH",labjack_pin:15,full_name:"Main Fuel (Ethanol) Valve",abbrev:"main",name:"ETH Main"},position:{width:2,height:1,x:11.5,y:15}},{pin:{test_stand:"ETH",labjack_pin:16,full_name:"Fuel (Ethanol) Fill Valve",abbrev:"fill",name:"ETH Fill"},position:{width:2,height:1,x:8,y:13}},{pin:{test_stand:"ETH",labjack_pin:17,full_name:"Fuel (Ethanol) Dump/Drain Valve",abbrev:"drain",name:"ETH Drain"},position:{width:2,height:1,x:4,y:13}},{pin:{test_stand:"ETH",labjack_pin:8,full_name:"Fuel (Ethanol) Tank Nitrogen Pressurisation Valve",abbrev:"pres",name:"ETH Pressurisation"},position:{width:2,height:1,x:8,y:4}},{pin:{test_stand:"ETH",labjack_pin:9,full_name:"Fuel (Ethanol) Tank Vent Valve",abbrev:"vent",name:"ETH Vent"},position:{width:2,height:1,x:11,y:1}},{pin:{test_stand:"ETH",labjack_pin:14,full_name:"Fuel (Ethanol) Line Nitrogen Purge Valve",abbrev:"purge",name:"ETH Purge"},position:{width:2,height:1,x:8,y:17}},{pin:{test_stand:"LOX",labjack_pin:15,full_name:"Main Oxidiser (LOX) Valve",abbrev:"main",name:"LOX Main"},position:{width:2,height:1,x:17.5,y:15}},{pin:{test_stand:"LOX",labjack_pin:16,full_name:"Oxidiser (LOX) Fill Valve",abbrev:"fill",name:"LOX Fill"},position:{width:2,height:1,x:21,y:13}},{pin:{test_stand:"LOX",labjack_pin:17,full_name:"Oxidiser (LOX) Dump/Drain Valve",abbrev:"drain",name:"LOX Drain"},position:{width:2,height:1,x:25,y:13}},{pin:{test_stand:"LOX",labjack_pin:8,full_name:"Oxidiser (LOX) Tank Nitrogen Pressurisation Valve",abbrev:"pres",name:"LOX Pressurisation"},position:{width:2,height:1,x:21,y:4}},{pin:{test_stand:"LOX",labjack_pin:9,full_name:"Oxidiser (LOX) Tank Vent Valve",abbrev:"vent",name:"LOX Vent"},position:{width:2,height:1,x:18,y:1}},{pin:{test_stand:"LOX",labjack_pin:14,full_name:"Oxidiser (LOX) Line Nitrogen Purge Valve",abbrev:"purge",name:"LOX Purge"},position:{width:2,height:1,x:21,y:17}}],sensors:[{pin:{test_stand:"LOX",labjack_pin:1,sensorNumber:0,full_name:"LOX Nitrogen Pressurant Sensor",abbrev:"lox_n2"},position:{width:5,height:3,x:25,y:3}},{pin:{test_stand:"LOX",labjack_pin:3,sensorNumber:1,full_name:"LOX Tank Pressure Sensor",abbrev:"lox_tank"},position:{width:3,height:4.5,x:17,y:7.5}},{pin:{test_stand:"ETH",labjack_pin:1,sensorNumber:2,full_name:"Ethanol Nitrogen Pressurant Sensor",abbrev:"eth_n2"},position:{width:5,height:3,x:1,y:3}},{pin:{test_stand:"ETH",labjack_pin:3,sensorNumber:3,full_name:"Ethanol Tank Pressure Sensor",abbrev:"eth_tank"},position:{width:3,height:4.5,x:11,y:7.5}}]}},51:function(t,e,n){t.exports=n(60)},56:function(t,e,n){},60:function(t,e,n){"use strict";n.r(e);var a=n(14),r=n(10),i=n(16),o=n(17),s=n(33),l=n(28),c=n(34),u=n(27),h=n(0),m=n.n(h),f=n(12),d=n.n(f),p=(n(56),n(21)),y=n(78),v=n(6),g=n(88);function b(t){var e=t.children;return m.a.createElement("div",{style:{width:"100%",padding:"6px",height:"40px"}},m.a.createElement("h1",null,e))}function k(){return m.a.createElement("div",{className:"top-bar"},m.a.createElement("img",{src:"./logo.png",alt:"logo"}),m.a.createElement("h1",null,"Test Stand Control Panel"))}function E(t){var e=t.children,n=t.title,a=Object(p.a)(t,["children","title"]);return m.a.createElement("div",Object.assign({className:"panel"},a),m.a.createElement(b,null,n),m.a.createElement(y.a,{style:{width:"100%",height:"calc(100% - 52px"}},e))}var w=Object(v.a)(function(t){return{root:{width:60,height:32,padding:1,display:"flex",overflow:"visible"},switchBase:{padding:2,color:t.palette.grey[500],"&$checked":{transform:"translateX(26px)",color:t.palette.common.white,"& + $track":{opacity:1,backgroundColor:t.palette.primary.main,borderColor:t.palette.primary.main}}},thumb:{marginLeft:1,marginTop:1,width:28,height:28,boxShadow:"none"},track:{border:"1px solid ".concat(t.palette.grey[500]),borderRadius:8,opacity:1,backgroundColor:t.palette.common.white},checked:{}}})(g.a);Object(v.a)(function(t){return{root:{position:"absolute",top:"-10px",left:"-10px",width:"6vw"}}})(g.a);function x(t){var e=t.value,n=t.setValue;return m.a.createElement("div",{className:"toggle-switch",style:{width:60}},m.a.createElement("span",{className:e?"inactive":"active"},"Off"),m.a.createElement(w,{checked:e,onChange:function(){return n(!e)}}),m.a.createElement("span",{className:e?"active":"inactive",style:{textAlign:"right",width:"100%",display:"block"}},"On"))}function O(t){var e="";e=t.children?t.children:m.a.createElement(x,{value:t.switchValue,setValue:t.setSwitchValue});var n=t.label?{cursor:"help",borderBottom:"1px dotted #333"}:{};return m.a.createElement("div",{className:"safety-card"},m.a.createElement("h2",{title:t.label,style:Object(a.a)({},n,t.style||{})},t.title),e)}var j={LINE_POWERED:"\u2705",BATTERY_POWERED:"\ud83d\udd0b",UNKNOWN:"\u2754"},M={LINE_POWERED:"Powered",BATTERY_POWERED:"Battery",UNKNOWN:"Unknown"};function S(t){var e=t.state,n=t.emit,a=t.sockStatus,r=t.that,i=null!==e.data&&e.data.arming_switch,o=null!==e.data&&e.data.manual_switch,s=null!==e.data&&e.data.data_logging,l=null===e.data?"UNKNOWN":e.data.UPS_status,c=j[l]+" "+M[l],u=a===WebSocket.OPEN?m.a.createElement("div",{style:{color:"green"}},"Connected"):m.a.createElement("div",{style:{color:"red"}}," Disconnected");return m.a.createElement(E,{title:"Safety",className:"panel safety"},m.a.createElement("div",{className:"flex",style:{justifyContent:"flex-start"}},m.a.createElement(O,{title:"Arming",label:"Controls if the state can change",isButton:"false",switchValue:i,setSwitchValue:function(t){return n("ARMINGSWITCH",t)}}),m.a.createElement(O,{title:"Manual",label:"Allow manual pin operation",isButton:"false",switchValue:o,setSwitchValue:function(t){return n("MANUALSWITCH",t)}}),m.a.createElement(O,{title:"Logging",label:"Logging data",isButton:"false",switchValue:s,setSwitchValue:function(t){return n("DATALOG",t)}}),m.a.createElement(O,{title:"Server IP",label:"Local IP address of the Raspberry Pi. Must be on the same network. If it's incorrect no new data will appear"},m.a.createElement("input",{value:e.wsAddress,size:"10",onChange:function(t){r.setState({wsAddress:t.target.value},function(){localStorage.setItem("wsaddr",t.target.value),r.connect()})},placeholder:e.defaultWSAddress})),m.a.createElement(O,{title:"Ping",label:"Time delay to reach the server",style:{width:40}},e.ping?e.ping:"0","ms"),m.a.createElement("div",{style:{paddingTop:6}},m.a.createElement(O,{title:"Status"},u),l&&m.a.createElement(O,{title:"UPS"},c))))}var _=n(8),N=n(25);function L(t,e){return parseFloat(t.toPrecision(e))}function T(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(0===t)return"0 "+e;for(var a=[["T",4],["G",3],["M",2],["K",1],["",0],["m",-1],["\u03bc",-2],["n",-3]],r=0;r<a.length;r++){var i=Math.pow(1e3,a[r][1]);if(Math.abs(t)>=i)return L(t/i,n)+" "+a[r][0]+e}return L(t/Math.pow(1e3,-4),n)+" p"+e}function P(t,e,n,a){for(var r=function t(e){if(e<0)return t(-e);if(0===e)return 0;var n=-Math.floor(Math.log10(e)),a=Math.log10(e)+n,r=[0,Math.log10(2),Math.log10(5),1],i=r[0],o=r[1],s=r[2],l=r[3],c=[Math.abs(a-i),Math.abs(a-o),Math.abs(a-s),Math.abs(a-l)],u=Math.min.apply(Math,c);return(u===c[0]?1:u===c[1]?2:u===c[2]?5:10)*Math.pow(10,-n)}((e-t)/n),i=[],o=Math.ceil(t/r)*r,s=Math.floor(e/r)*r,l=o;l<=s;l+=r)Math.abs(l)<1e-10&&(l=0),i.push({tick:l,label:T(l,a)});return i}function C(t,e,n){for(var a,r=0,i=n-1;r<=i;){var o=t(a=Math.floor((r+i)/2));if(o===e)return a;o<e?r=a+1:i=a-1}return i}function A(t,e){return t?e?[Math.min(t[0],e[0]),Math.max(t[1],e[1])]:t:e}function W(t,e){var n=Object(_.a)(t,2);return function(t,e){var n=Object(_.a)(t,2),a=n[0],r=n[1],i=Object(_.a)(e,2);return[a+(r-a)*i[0],r-(r-a)*(1-i[1])]}([n[0],n[1]],[-e,1+e])}function X(t,e,n){return Math.max(e,Math.min(n,t))}function F(t,e){var n=Object(_.a)(t,2),a=n[0],r=n[1],i=Object(_.a)(e,2),o=i[0],s=i[1];return a<o&&r>s?[o,s]:a<o?[o,o+(r-a)]:r>s?[s-(r-a),s]:[a,r]}function I(t){var e;try{e=t()}catch(n){if(!(n instanceof TypeError))throw n;e=void 0}return e}var V=function(){function t(e){Object(i.a)(this,t),this.capacity=e,this.array=new Float64Array(this.capacity),this.size=0,this.chunks=0}return Object(o.a)(t,[{key:"push",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];try{this.array.set(e,this.size),this.size+=e.length,this.chunks++}catch(a){console.error(this,e),console.error(a)}}},{key:"shrink",value:function(){var t=new Float64Array(this.size);t.set(this.array.subarray(0,this.size)),this.array=t}},{key:"filterMapChunks",value:function(t,e){for(var n=[],a=0;a<this.chunks;a++)t(a)&&n.push(e(a));return n}}]),t}(),z=function(t){function e(t){return Object(i.a)(this,e),Object(s.a)(this,Object(l.a)(e).call(this,4*t))}return Object(c.a)(e,t),Object(o.a)(e,[{key:"time",value:function(t){return this.array[4*t]}},{key:"mean",value:function(t){return this.array[4*t+1]}},{key:"min",value:function(t){return this.array[4*t+2]}},{key:"max",value:function(t){return this.array[4*t+3]}},{key:"updateDecimation",value:function(t){var e=t.chunks;this.chunks=Math.ceil(e/2),this.size=4*this.chunks;var n=this.size;if(0!==e)switch(e%2){case 0:this.array[n-4]=t.time(e-1),this.array[n-3]=(t.mean(e-2)+t.mean(e-1))/2,this.array[n-2]=Math.min(t.min(e-2),t.min(e-1)),this.array[n-1]=Math.max(t.max(e-2),t.max(e-1));break;case 1:this.array[n-4]=t.time(e-1),this.array[n-3]=t.mean(e-1),this.array[n-2]=t.min(e-1),this.array[n-1]=t.max(e-1)}}}]),e}(V),D=function(t){function e(t){return Object(i.a)(this,e),Object(s.a)(this,Object(l.a)(e).call(this,2*t))}return Object(c.a)(e,t),Object(o.a)(e,[{key:"time",value:function(t){return this.array[2*t+0]}},{key:"mean",value:function(t){return this.array[2*t+1]}},{key:"min",value:function(t){return this.array[2*t+1]}},{key:"max",value:function(t){return this.array[2*t+1]}}]),e}(V),R=function(){function t(){Object(i.a)(this,t),this.n_bound=12,this.capacity=524288,this.arrays={},this.arrays[0]=new D(this.capacity);for(var e=1;e<=this.n_bound;e++)this.arrays[e]=new z(this.capacity>>e)}return Object(o.a)(t,[{key:"push",value:function(t,e){this.arrays[0].push(t,e);for(var n=1;n<=this.n_bound;n++)this.arrays[n].updateDecimation(this.arrays[n-1])}},{key:"sample",value:function(t,e){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,r=[Math.max(C(function(t){return n.arrays[0].time(t)},t,this.arrays[0].chunks),0),Math.min(C(function(t){return n.arrays[0].time(t)},e,this.arrays[0].chunks)+2,this.arrays[0].chunks)],i=r[1]-r[0],o=Math.min(this.n_bound,Math.max(0,1+Math.floor(Math.log(i/a+.01)/Math.log(2))))||0,s=[Math.max(C(function(t){return n.arrays[o].time(t)},t,this.arrays[o].chunks),0),Math.min(C(function(t){return n.arrays[o].time(t)},e,this.arrays[o].chunks)+2,this.arrays[o].chunks)],l=s[1]-s[0],c=new Array(l);c.min=1/0,c.max=-1/0;for(var u=0;u<l;u++)c[u]=[this.arrays[o].time(s[0]+u),this.arrays[o].mean(s[0]+u),this.arrays[o].min(s[0]+u),this.arrays[o].max(s[0]+u)],c.min=Math.min(c.min,c[u][2]),c.max=Math.max(c.max,c[u][3]);return c.decimated=o>0,c.getPoints=function(t,e,n){for(var a="",r=0;r<l;r++)a+="".concat(t(c[r][0]-n).toFixed(1),",").concat(Math.round(e(c[r][1]))," ");return a},c.getMinMaxPoints=function(t,e,n){for(var a="",r=0;r<l;r++)a+="".concat(t(c[r][0]-n).toFixed(1),",").concat(Math.round(e(c[r][2]))," ");for(var i=l-1;i>=0;i--)a+="".concat(t(c[i][0]-n).toFixed(1),",").concat(Math.round(e(c[i][3]))," ");return a},c}},{key:"samplePreview",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,n=this.arrays[0].chunks,a=Math.ceil(n/e),r=1/0,i=-1/0,o=this.arrays[0].filterMapChunks(function(t){return t%a===0||t===n-1},function(e){var n=t.arrays[0].mean(e);return r=Math.min(r,n),i=Math.max(i,n),[t.arrays[0].time(e),n]});return o.min=r,o.max=i,o.getPoints=function(t,e,n){for(var a="",r=0;r<o.length;r++)a+="".concat(t(o[r][0]-n).toFixed(1),",").concat(Math.round(e(o[r][1]))," ");return a},o}},{key:"shrink",value:function(){for(var t=0;t<=this.n_bound;t++)this.arrays[t].shrink()}}]),t}(),H=function(){function t(){Object(i.a)(this,t),this.series=[new R],this.enabled=!0}return Object(o.a)(t,[{key:"push",value:function(t,e){isNaN(t)||isNaN(e)?this.series[this.series.length-1].arrays[0].chunks>0&&(this.series[this.series.length-1].shrink(),this.series.push(new R)):this.series[this.series.length-1].push(t,e)}},{key:"sample",value:function(t,e,n){var a=this.series.map(function(a){return a.sample(t,e,n)});return a.totalLength=a.reduce(function(t,e){return t+e.length},0),a.splitPointIndex=function(t){for(var e=0;e<a.length;e++){if(t<a[e].length)return[e,t];if((t-=a[e].length)<0)return[-1,-1]}},a.fromPointIndex=function(t){var e=a.splitPointIndex(t),n=Object(_.a)(e,2),r=n[0],i=n[1];return a[r][i]},a.min=Math.min.apply(Math,Object(r.a)(a.map(function(t){return t.min}))),a.max=Math.max.apply(Math,Object(r.a)(a.map(function(t){return t.max}))),a}},{key:"samplePreview",value:function(t){if(0===this.series.length||0===this.series[0].arrays[0].chunks)return[];var e=[this.minTime(),this.maxTime()];if(e[0]===e[1])return[];var n=this.series.filter(function(t){return t.arrays[0].chunks}).map(function(n){var a=(n.arrays[0].time(n.arrays[0].chunks-1)-n.arrays[0].time(0))/(e[1]-e[0]);return n.samplePreview(t*a)});return n.min=Math.min.apply(Math,Object(r.a)(n.map(function(t){return t.min}))),n.max=Math.max.apply(Math,Object(r.a)(n.map(function(t){return t.max}))),n}},{key:"minTime",value:function(){var t=this;return I(function(){return t.series[0].arrays[0].time(0)})}},{key:"maxTime",value:function(){for(var t=this.series.length-1;t>=0;t--)if(this.series[t].arrays[0].chunks>0)return this.series[t].arrays[0].time(this.series[t].arrays[0].chunks-1);return NaN}}]),t}(),B=function(){function t(e){Object(i.a)(this,t),this.series=e,this.keys=Array.from(Object.keys(this.series)),this.arrays=this.objectMap(function(t){return new H})}return Object(o.a)(t,[{key:"objectMap",value:function(t){return this.keys.reduce(function(e,n){return e[n]=t(n),e},{})}},{key:"minTime",value:function(){var t=this;return Math.min.apply(Math,Object(r.a)(this.keys.map(function(e){return t.arrays[e].minTime()}).filter(function(t){return t})))}},{key:"sample",value:function(t,e){var n=this,a=this.objectMap(function(a){var i;return n.arrays[a].enabled&&(i=n.arrays[a]).sample.apply(i,Object(r.a)(t).concat([e]))});return a.min=Math.min.apply(Math,Object(r.a)(this.keys.filter(function(t){return n.arrays[t].enabled}).map(function(t){return a[t].min}))),a.max=Math.max.apply(Math,Object(r.a)(this.keys.filter(function(t){return n.arrays[t].enabled}).map(function(t){return a[t].max}))),a}},{key:"samplePreview",value:function(t){var e=this,n=this.objectMap(function(n){return e.arrays[n].enabled&&e.arrays[n].samplePreview(t)});return n.min=Math.min.apply(Math,Object(r.a)(this.keys.filter(function(t){return e.arrays[t].enabled}).map(function(t){return n[t].min}))),n.max=Math.max.apply(Math,Object(r.a)(this.keys.filter(function(t){return e.arrays[t].enabled}).map(function(t){return n[t].max}))),n}},{key:"toggleSeries",value:function(t){this.arrays[t].enabled=!this.arrays[t].enabled}}]),t}(),U=n(32);function G(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Y(t){return U.buttons.filter(function(e){return e.pin.labjack_pin===t})[0]}window.enablePageScroll=N.enablePageScroll,window.disablePageScroll=N.disablePageScroll;var Q=null,J=[-10,10],K=function(t){return document.dispatchEvent(new CustomEvent("datalogger-new-data",{detail:t}))};var $=function(t){var e=t.series,n=t.unit,i=(t.label,Array.from(Object.keys(e))),o=new B(e),s=[],l=function(){},c=function(){return requestAnimationFrame(l)};return document.addEventListener("datalogger-new-data",function(t){var e,n=t.detail,a=G(i);try{for(a.s();!(e=a.n()).done;){var r=e.value;r in n&&o.arrays[r].push(n.time,n[r])}}catch(s){a.e(s)}finally{a.f()}c()}),document.addEventListener("datalogger-new-event",function(t){var e=t.detail;s.push(Object(a.a)({},e,{key:s.length})),c()}),function(t){var c=t.currentSeconds,u=m.a.useRef(null);l=m.a.useReducer(function(t){return t+1},0)[1];var h=600,f=450;c||(c=(new Date).getTime()/1e3);var d,y,v,g=o.minTime(),b=m.a.useState([-3]),k=Object(_.a)(b,2),E=k[0],w=k[1],x=function(t){if(1===t.length||t[1]>=c){var e=1===t.length?t[0]:t[0]-c,n=Math.min(-10,g-c);w([X(e,n,0)])}else t=[Math.min.apply(Math,Object(r.a)(t)),Math.max.apply(Math,Object(r.a)(t))],w([X(t[0],g,t[1]-.01),X(t[1],t[0],c)])},O=1===E.length?[c+E[0],c]:E,j=[O[0]-c,O[1]-c],M=o.sample(O,h),S=o.samplePreview(h);d=Q,y=A([M.min,M.max],J),v=.1;var L=W(Q=d?y?[d[0]+(y[0]-d[0])*v,d[1]+(y[1]-d[1])*v]:d:y,.2),V=[g,c],z=1,D=1,R=1,H=1,B=function(t){return z+t*(h-z-D)},U=function(t){return R+t*(400-R-H)},G=function(t){return(t-z)/(h-z-D)},q=function(t){return B((t-j[0])/(j[1]-j[0]))},Y=function(t){return U(1-(t-L[0])/(L[1]-L[0]))},K=function(t){return j[0]+G(t)*(j[1]-j[0])},$=6,Z=12,tt=function(t){return e=1-(t-S.min)/(S.max-S.min),$+e*(50-$-Z);var e},et=function(t){return B(1-t/(Math.min(V[1]-10,V[0])-V[1]))},nt=function(t){return(1-G(t))*(Math.min(V[1]-10,V[0])-V[1])},at=P.apply(void 0,j.concat([4,"s"])),rt=P.apply(void 0,Object(r.a)(L).concat([6,"psi"])),it=m.a.useState(null),ot=Object(_.a)(it,2),st=ot[0],lt=ot[1],ct=i.map(function(t){if(!M[t]||!M[t].length)return null;var e=C(function(e){return M[t].fromPointIndex(e)[0]},c+K(st),M[t].totalLength-1);if(-1===e)return null;var n=M[t].splitPointIndex(e),a=Object(_.a)(n,2),r=a[0],i=a[1];return i>=M[t][r].length-1||r<0||i<0?null:[r,i]}).map(function(t,e){if(null===t)return"";var a,r,o,s,l,u=Object(_.a)(t,2),h=u[0],m=u[1],f=M[i[e]],d=(a=f[h][m][0],r=f[h][m][1],o=f[h][m+1][0],s=f[h][m+1][1],l=c+K(st),r+(s-r)*(l-a)/(o-a));return"".concat(i[e],": ").concat(T(d,n))}).filter(function(t){return t.length}),ut=st>B(1)-200,ht=m.a.useState(!1),mt=Object(_.a)(ht,2),ft=mt[0],dt=mt[1],pt=m.a.useState(null),yt=Object(_.a)(pt,2),vt=yt[0],gt=yt[1],bt=function(t){return t.clientX-I(function(){return u.current.getBoundingClientRect().left})},kt=s.map(function(t){var e=t.time,n=Object(p.a)(t,["time"]);return Object(a.a)({x:q(e-c)},n)}).filter(function(t){var e=t.x;return e>=B(0)-10&&e<=B(1)}),Et=O[1]-O[0]<15;m.a.useEffect(function(){document.body.addEventListener("mouseup",function(){dt(!1),gt(null),Ct(!1),Ft(null),jt(!1),Nt(null)})},[]);var wt=m.a.useState(!1),xt=Object(_.a)(wt,2),Ot=xt[0],jt=xt[1],Mt=m.a.useState(null),St=Object(_.a)(Mt,2),_t=St[0],Nt=St[1],Lt=m.a.useState(!1),Tt=Object(_.a)(Lt,2),Pt=Tt[0],Ct=Tt[1],At=m.a.useState(null),Wt=Object(_.a)(At,2),Xt=Wt[0],Ft=Wt[1],It=function(t,e){jt(!0),Nt(e)},Vt=function(t){var e=bt(t);if(Pt){var n=Object(_.a)(Xt,2),a=n[0],i=n[1],o=nt(e)-a,s=[i[0]+o,i[1]+o];x(F(s,V))}if(Ot){var l=_t,u=Object(r.a)(O);u[l]=X(c+nt(e),Math.min(V[1]-10,V[0]),V[1]),0===l?u[0]=Math.min(u[1]-.01,u[0]):u[1]=Math.max(u[0]+.01,u[1]),x(u)}};return m.a.createElement("div",{onMouseMove:function(t){return Pt?Vt(t):function(t){var e=bt(t);if(lt(e),ft){var n=Object(_.a)(vt,2),a=n[0],r=n[1],i=K(a)-K(e),o=[r[0]+i,r[1]+i];o=F(o,A(V,[c-10,c])),x(o)}}(t)}},m.a.createElement("svg",{viewBox:"0 0 ".concat(h," ").concat(400),xmlns:"http://www.w3.org/2000/svg",width:h,height:400,style:{userSelect:"none",fontFamily:"sans-serif",display:"block"},ref:u,onMouseOver:function(){return Object(N.disablePageScroll)()},onMouseOut:function(t){var e=u.current.getBoundingClientRect();Object(N.enablePageScroll)(),(t.clientX<e.left||t.clientX>e.right||t.clientY<e.top||t.clientY>e.bottom)&&lt(null)},onMouseDown:function(t){dt(!0),gt([bt(t),O])},onWheel:function(t){var e=t.deltaX+t.deltaY,n=1===E.length?O[1]:st?c+K(st):(O[0]+O[1])/2,a=Math.max(n+(O[0]-n)*Math.pow(1.001,e),Math.min(V[0]+.01,c-10)),r=Math.min(n+(O[1]-n)*Math.pow(1.001,e),V[1]);x([Math.min(a,r-.01),r])}},at.map(function(t){var e=t.tick;return t.label,m.a.createElement("line",{key:e,x1:q(e),y1:U(1),x2:q(e),y2:U(0),stroke:"#ddd"})}),m.a.createElement("line",{x1:0,y1:U(1),x2:h,y2:U(1),stroke:"#888",strokeWidth:"2"}),rt.map(function(t){var e=t.tick;return t.label,m.a.createElement("line",{key:e,x1:B(0),y1:Y(e),x2:B(1),y2:Y(e),stroke:"#ddd"})}),m.a.createElement("line",{x1:B(0),y1:0,x2:B(0),y2:f,stroke:"#888",strokeWidth:"2"}),kt.map(function(t,e){var n=t.x,a=t.label,r=t.key;return m.a.createElement("g",{key:r},m.a.createElement("line",{x1:n,y1:U(0),x2:n,y2:U(1),stroke:"#333",strokeWidth:"1",strokeDasharray:"2 4"}),Et&&m.a.createElement("text",{x:n+5,y:U(1)-e%10*12-20,textAnchor:"start",alignmentBaseline:"text-after-edge",fontSize:"12"},a))}),i.map(function(t){return m.a.createElement("g",{key:t},M[t]&&M[t].map(function(n,a){return n.length&&n.decimated&&m.a.createElement("polygon",{key:a,points:n.getMinMaxPoints(q,Y,c),fill:e[t].color,opacity:"0.5",stroke:"none",strokeWidth:"0"})}),M[t]&&M[t].map(function(n,a){return n.length&&m.a.createElement("polyline",{key:a,points:n.getPoints(q,Y,c),fill:"none",stroke:e[t].color,strokeWidth:"1"})}))}),at.map(function(t){var e=t.tick,n=t.label;return q(e)-B(0)>40&&m.a.createElement("text",{key:e,x:q(e),y:U(1)-2,textAnchor:"middle",alignmentBaseline:"after-edge",fontSize:"12"},n)}),rt.map(function(t){var e=t.tick,n=t.label;return U(1)-Y(e)>20&&m.a.createElement("text",{key:e,x:B(0)+2,y:Y(e),textAnchor:"start",alignmentBaseline:"after-edge",fontSize:"12"},n)}),ct.length&&st>B(0)&&m.a.createElement("g",null,m.a.createElement("line",{x1:st,y1:U(0),x2:st,y2:U(1),stroke:"black",strokeWidth:"1"}),ct.map(function(t,e){return m.a.createElement("text",{key:e,x:Math.max(50,Math.min(st+(ut?-5:5),B(1)-100)),y:U(0)+18+20*e,textAnchor:ut?"end":"start",alignmentBaseline:"text-after-edge",fontSize:"12"},t)})),i.map(function(t,n){return m.a.createElement("g",{key:t,onClick:function(e){return o.toggleSeries(t)},cursor:"pointer"},m.a.createElement("rect",{x:500,y:20*n,width:"100",height:"20",fill:"transparent"}),m.a.createElement("circle",{r:"4",fill:o.arrays[t].enabled?e[t].color:"lightgrey",cx:590,cy:12+20*n}),m.a.createElement("text",{fontSize:"12",x:580,textAnchor:"end",alignmentBaseline:"middle",fill:o.arrays[t].enabled?e[t].color:"lightgrey",y:13+20*n},t))})),m.a.createElement("svg",{viewBox:"0 0 ".concat(h," ",50),xmlns:"http://www.w3.org/2000/svg",width:h,height:50,style:{userSelect:"none",fontFamily:"sans-serif",display:"block"},onMouseOut:function(t){Object(N.enablePageScroll)()},onMouseMove:Vt,onMouseDown:function(t){Ct(!0),Ft([nt(bt(t)),O])}},m.a.createElement("rect",{x:et(j[0]),y:-2,width:et(j[1])-et(j[0]),height:54,fill:"#eee",stroke:"#999",strokeWidth:"2"}),i.map(function(t){return m.a.createElement("g",{key:t},S[t]&&S[t].map(function(n,a){return n.length&&m.a.createElement("polyline",{key:a,points:n.getPoints(et,tt,c),fill:"none",stroke:e[t].color,strokeWidth:"1"})}))}),m.a.createElement("text",{x:"2",y:"50",alignmentBaseline:"text-after-edge",textAnchor:"start",fontSize:"12",fill:"grey"},Math.max(10,Math.round(V[1]-V[0])),"s ago"),m.a.createElement("text",{x:598,y:"50",alignmentBaseline:"text-after-edge",textAnchor:"end",fontSize:"12",fill:"grey"},"now"),m.a.createElement("rect",{x:et(j[1])-4,y:10,width:8,height:30,fill:"#999",stroke:"none",strokeWidth:"0",rx:"4"}),m.a.createElement("rect",{x:et(j[0])-4,y:10,width:8,height:30,fill:"#999",stroke:"none",strokeWidth:"0",rx:"4"}),m.a.createElement("rect",{x:et(j[1])-6,onMouseDown:function(t){return It(0,1)},y:"0",width:"16",height:"50",fill:"transparent",stroke:"none",strokeWidth:"0",cursor:"col-resize"}),m.a.createElement("rect",{x:et(j[0])-10,onMouseDown:function(t){return It(0,0)},y:"0",width:"16",height:"50",fill:"transparent",stroke:"none",strokeWidth:"0",cursor:"col-resize"}),1!==E.length&&m.a.createElement("g",{cursor:"pointer",onClick:function(){return x([E[0]-E[1]])}},m.a.createElement("rect",{x:584,y:"2",width:"15",height:"18",fill:"#999",stroke:"none",strokeWidth:"0",rx:"4"}),m.a.createElement("polyline",{points:"".concat(589,",6 ").concat(595,",11 ").concat(589,",16"),fill:"none",stroke:"#fff",strokeWidth:"2"}))),m.a.createElement("button",{onClick:function(){var t=u.current,e=(new XMLSerializer).serializeToString(t),n=new Blob([e],{type:"image/svg+xml"}),a=URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download="graph.svg",r.click()}},"Download SVG"))}}({unit:"psi",series:{"LOX Tank":{color:"#000"},"LOX N2":{color:"#f00"},"ETH Tank":{color:"#3d6"},"ETH N2":{color:"#09f"}}});function Z(t){var e=t.state;return m.a.createElement(E,{title:"Graphs",className:"panel graphs"},m.a.createElement($,{currentSeconds:I(function(){return e.data.time})}))}var tt=n(45),et=n(81),nt=n(82),at=n(83),rt=n(84),it=n(85);function ot(){ot=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",o=a.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(M){s=function(t,e,n){return t[e]=n}}function l(t,e,n,a){var r=e&&e.prototype instanceof h?e:h,i=Object.create(r.prototype),o=new x(a||[]);return i._invoke=function(t,e,n){var a="suspendedStart";return function(r,i){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===r)throw i;return j()}for(n.method=r,n.arg=i;;){var o=n.delegate;if(o){var s=k(o,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===a)throw a="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a="executing";var l=c(t,e,n);if("normal"===l.type){if(a=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a="completed",n.method="throw",n.arg=l.arg)}}}(t,n,o),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(M){return{type:"throw",arg:M}}}t.wrap=l;var u={};function h(){}function m(){}function f(){}var d={};s(d,r,function(){return this});var p=Object.getPrototypeOf,y=p&&p(p(O([])));y&&y!==e&&n.call(y,r)&&(d=y);var v=f.prototype=h.prototype=Object.create(d);function g(t){["next","throw","return"].forEach(function(e){s(t,e,function(t){return this._invoke(e,t)})})}function b(t,e){var a;this._invoke=function(r,i){function o(){return new e(function(a,o){!function a(r,i,o,s){var l=c(t[r],t,i);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){a("next",t,o,s)},function(t){a("throw",t,o,s)}):e.resolve(h).then(function(t){u.value=t,o(u)},function(t){return a("throw",t,o,s)})}s(l.arg)}(r,i,a,o)})}return a=a?a.then(o,o):o()}}function k(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var a=c(n,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,u;var r=a.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function x(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function e(){for(;++a<t.length;)if(n.call(t,a))return e.value=t[a],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:j}}function j(){return{value:void 0,done:!0}}return m.prototype=f,s(v,"constructor",f),s(f,"constructor",m),m.displayName=s(f,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,s(t,o,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},g(b.prototype),s(b.prototype,i,function(){return this}),t.AsyncIterator=b,t.async=function(e,n,a,r,i){void 0===i&&(i=Promise);var o=new b(l(e,n,a,r),i);return t.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},g(v),s(v,o,"Generator"),s(v,r,function(){return this}),s(v,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var a=e.pop();if(a in t)return n.value=a,n.done=!1,n}return n.done=!0,n}},t.values=O,x.prototype={constructor:x,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function a(n,a){return o.type="throw",o.arg=t,e.next=n,a&&(e.method="next",e.arg=void 0),!!a}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),w(n),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;w(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:O(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},t}function st(t){return m.a.createElement(et.a,{style:t.inFlight?{background:"#94F690"}:{}},m.a.createElement(nt.a,{align:"right"},t.name[0]+t.name.substring(1).toLowerCase()),m.a.createElement(nt.a,{colSpan:"2"},t.stand?Y(t.pin).pin.name:((t.inFlight?t.remaining:t.ms)/1e3).toFixed(1)+"s"))}function lt(t){var e=t.state,n=t.emit,a=e.data&&e.data.current_sequence||[],r=null===e.data?null:e.data.command_in_flight,i=!!e.data&&3===e.data.status,o=function(){var t=Object(tt.a)(ot().mark(function t(){return ot().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n("SETSEQUENCE",prompt("Enter a sequence name like 'operation' or 'abort' (lowercase without quotes). (This loads from a sequence file in src/sequences on the server RPi, you must edit the files on the RPi to change the sequence.)"));case 2:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),s=e.data&&e.data.arming_switch;return m.a.createElement(E,{title:"Sequences"},m.a.createElement("div",{className:"flex"},m.a.createElement("div",{style:{width:"200px",borderRight:"1px solid #999",height:"100%"}},m.a.createElement("div",{className:"frame"},m.a.createElement("h2",null,"Start"),m.a.createElement("div",null,m.a.createElement("button",{onClick:o,disabled:!s},"Choose sequence")),m.a.createElement("br",null),m.a.createElement("button",{onClick:function(){return n("BEGINSEQUENCE",null)},style:{backgroundColor:s?"lime":"lightgrey",padding:10,cursor:s&&"pointer"},disabled:!s},"Start"),m.a.createElement("br",null),m.a.createElement("br",null),m.a.createElement(O,{title:"Abort"},m.a.createElement("button",{onClick:function(){return n("ABORTSEQUENCE",t);var t},style:{backgroundColor:s?"tomato":"lightgrey",padding:10,cursor:s&&"pointer"},disabled:!s},"ABORT")))),m.a.createElement("div",{style:{overflow:"auto",width:"100%",height:"100%"}},m.a.createElement(at.a,{stickyHeader:!0,"aria-label":"simple table",style:{tableLayout:"fixed"}},m.a.createElement(rt.a,null,m.a.createElement(et.a,null,m.a.createElement(nt.a,{align:"right",style:{width:100}},"Command"),m.a.createElement(nt.a,null,"Parameter"),m.a.createElement(nt.a,{align:"right"},!i&&m.a.createElement(m.a.Fragment,null,r&&m.a.createElement("button",{onClick:function(){return n("PAUSESEQUENCE",null)}},"Pause"),(a.length||r)&&m.a.createElement("button",{onClick:function(){return n("UNSETSEQUENCE",null)}},"Clear"))))),m.a.createElement(it.a,null,r&&m.a.createElement(st,Object.assign({inFlight:!0},r)),a.map(function(t){return m.a.createElement(st,t)}))))))}function ct(t,e,n,a){return 14.504*((t/120-n/1e3)/(a/1e3)*e)}var ut={eth_tank:{barMax:100,zero:3.99,span:16.02},lox_tank:{barMax:100,zero:3.99,span:16.04},eth_n2:{barMax:250,zero:4,span:16},lox_n2:{barMax:250,zero:4,span:16}};function ht(t,e){return 14.504*(e/2.4*(t-.48))}var mt={time:NaN,"LOX Tank":NaN,"LOX N2":NaN,"ETH Tank":NaN,"ETH N2":NaN};function ft(t){return 26*t}function dt(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.enabled;return Object(a.a)({position:"absolute",borderStyle:"solid",borderColor:"transparent",width:ft(r),height:ft(i),top:ft(n),left:ft(e)},o?{}:{cursor:"help"})}function pt(t){var e=t.state,n=t.emit,a=Object(p.a)(t,["state","emit"]),r=null!==e.data&&e.data.labjacks[a.test_stand].digital[a.labjack_pin],i=dt(a),o={position:"absolute",margin:"auto",fontSize:"1rem",top:ft(a.y-1),left:ft(a.x-1)-6,width:100,textAlign:"center"};return m.a.createElement("div",null,e.data&&m.a.createElement("div",{style:i,title:a.enabled?"":"Please enable the arming and manual control switches to toggle"},m.a.createElement(g.a,{checked:r,onChange:function(){return e.data.labjacks[a.test_stand].digital[a.labjack_pin]?n("CLOSE",{name:a.test_stand,pin:parseInt(a.labjack_pin)}):n("OPEN",{name:a.test_stand,pin:parseInt(a.labjack_pin)})},disabled:!a.enabled}),m.a.createElement("label",{className:(r?"active":"inactive")+" control-label "+(a.enabled?"":"disabled")},m.a.createElement("br",null),r?"Open":"Closed")),m.a.createElement("h4",{style:o},a.title))}function yt(t){var e=t.state,n=(t.emit,Object(p.a)(t,["state","emit"])),r=dt(Object(a.a)({enabled:!0},n)),i=null,o=null;if(e.data){i=e.data.labjacks[n.test_stand].analog[n.labjack_pin];var s=ut[n.sensorName];o=ct(i,s.barMax,s.zero,s.span)}return o&&o>29.3918&&(r.backgroundColor="tomato"),m.a.createElement("div",{style:r},m.a.createElement("div",null,n.title),o&&m.a.createElement("div",null,o.toFixed(1)," PSI"),i&&m.a.createElement("div",null,"(",i.toFixed(2),"V)"))}function vt(t){var e=t.state,n=t.emit;return m.a.createElement(E,{title:"Control Panel",className:"panel control"},m.a.createElement("div",{className:"control-panel"},U.buttons.map(function(t){return e.data&&m.a.createElement(pt,Object.assign({title:t.pin.test_stand.charAt(0)+" "+t.pin.abbrev,key:t.pin.name,state:e,emit:n},t.pin,t.position,{enabled:e.data&&e.data.arming_switch&&e.data.manual_switch}))}),U.sensors.map(function(t){return e.data&&m.a.createElement(yt,Object.assign({title:t.pin.abbrev,key:t.pin.name,state:e,emit:n},t.pin,t.position,{sensorName:t.pin.abbrev}))})))}var gt=n(87),bt=n(86),kt=function(t){function e(t){var n;return Object(i.a)(this,e),(n=Object(s.a)(this,Object(l.a)(e).call(this,t))).state={data:null,mostRecentWarning:{},showWarning:!1,wsAddress:localStorage.getItem("wsaddr")||"192.168.0.5",defaultWSAddress:"192.168.0.5",events:[],socketStatus:-1},n.emit=n.emit.bind(Object(u.a)(Object(u.a)(n))),n.connect(),n}return Object(c.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.interval=setInterval(function(){return t.emit("PING")},200),this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1,clearInterval(this.interval)}},{key:"pushWarning",value:function(t,e){(!this.state.mostRecentWarning||this.state.mostRecentWarning.time!==t&&this.state.mostRecentWarning.message!==e)&&this.setState({mostRecentWarning:{time:t,message:e},showWarning:!0})}},{key:"updateSocketStatus",value:function(){if(this.socket){var t={socketStatus:this.socket.readyState};this.socket.readyState!==WebSocket.OPEN&&this.pushWarning((new Date).getTime(),"Server connection lost"),this.setState(t)}}},{key:"connect",value:function(){var t=this;this.socket&&this.socket.close();try{this.socket=new WebSocket("ws://".concat(this.state.wsAddress,":8888")),this.updateSocketStatus(),this.socket.onopen=function(e){console.log("websocket connection established"),t.updateSocketStatus()},this.socket.onclose=function(e){t.updateSocketStatus(),t.socket=null,console.log("websocket connection lost. reconnecting..."),K(mt),setTimeout(function(){t.socket||t.connect()},1e3)},this.socket.onmessage=function(e){if(t.mounted){t.updateSocketStatus();var n,i,o=JSON.parse(e.data);switch(o.type){case"STATE":o.data.time=parseInt(o.data.time)/1e3;var s=I(function(){return t.state.data.time});o.data.time-s>1&&K(mt),K({time:(i=o.data).time,"LOX Tank":ct(i.labjacks.LOX.analog[3],ut.lox_tank.barMax,ut.lox_tank.zero,ut.lox_tank.span),"LOX N2":ht(i.labjacks.LOX.analog[1],250),"ETH Tank":ct(i.labjacks.ETH.analog[3],ut.eth_tank.barMax,ut.eth_tank.zero,ut.eth_tank.span),"ETH N2":ht(i.labjacks.ETH.analog[1],250)}),t.setState({data:o.data}),o.data.latest_warning&&t.pushWarning(o.data.latest_warning[0],o.data.latest_warning[1]);break;case"PING":t.setState({ping:(new Date).getTime()-o.data});break;case"VALVE":var l=o.time/1e3,c=Y(o.data.pin).pin,u=("CLOSE"===o.data.header?"Closed":"Opened")+" "+c.test_stand+" "+c.abbrev;n={time:l,label:u},document.dispatchEvent(new CustomEvent("datalogger-new-event",{detail:n})),t.setState({events:[].concat(Object(r.a)(t.state.events),[Object(a.a)({},o.data,{label:u,time:l})])});break;default:console.error(o)}}}}catch(e){console.error(e)}}},{key:"emit",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.socket&&this.socket.readyState===WebSocket.OPEN&&this.socket.send(JSON.stringify({header:t,data:e,time:(new Date).getTime()}))}},{key:"render",value:function(){var t=this;return m.a.createElement("div",null,m.a.createElement(k,null),m.a.createElement("div",{className:"panels-root"},m.a.createElement("div",{className:"panel-row-1"},m.a.createElement(S,{state:this.state,emit:this.emit,sockStatus:this.state.socketStatus,that:this}),m.a.createElement(lt,{state:this.state,emit:this.emit})),m.a.createElement("div",{className:"panel-row-2"},m.a.createElement(vt,{state:this.state,emit:this.emit}),m.a.createElement(Z,{state:this.state,emit:this.emit})),this.state.showWarning&&m.a.createElement(gt.a,{open:!0,onClose:function(){return t.setState({showWarning:!1})},message:this.state.mostRecentWarning.message,action:m.a.createElement(bt.a,{onClick:function(){return t.setState({showWarning:!1})},style:{color:"white",textTransform:"none",textDecoration:"underline"}},"Dismiss")})))}}]),e}(m.a.Component);d.a.render(m.a.createElement(m.a.StrictMode,null,m.a.createElement(kt,null)),document.getElementById("root"))}},[[51,2,1]]]);
//# sourceMappingURL=main.4759ab8b.chunk.js.map